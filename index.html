<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a data-ice="repoURL" href="https://github.com/mkopit/url-embed.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">classes</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/Embed.js~Embed.html">Embed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/EmbedEngine.js~EmbedEngine.html">EmbedEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/lib/classes/OEmbedProvider.js~OEmbedProvider.html">OEmbedProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/lib/classes/URLEmbedProvider.js~URLEmbedProvider.html">URLEmbedProvider</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">classes/default_providers</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/DailyMotion.js~DailyMotion.html">DailyMotion</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/FacebookPosts.js~FacebookPosts.html">FacebookPosts</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/FacebookVideo.js~FacebookVideo.html">FacebookVideo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Flickr.js~Flickr.html">Flickr</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Imgur.js~Imgur.html">Imgur</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Instagram.js~Instagram.html">Instagram</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Soundcloud.js~SoundCloud.html">SoundCloud</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Spotify.js~Spotify.html">Spotify</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Tumblr.js~Tumblr.html">Tumblr</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Twitter.js~Twitter.html">Twitter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Videopress.js~Videopress.html">Videopress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Vimeo.js~Vimeo.html">Vimeo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/default_providers/Youtube.js~Youtube.html">Youtube</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">classes/errors</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/errors/EmbedValidationError.js~EmbedValidationError.html">EmbedValidationError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/errors/UnexpectedStatusError.js~UnexpectedStatusError.html">UnexpectedStatusError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/classes/errors/UnknownProviderError.js~UnknownProviderError.html">UnknownProviderError</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="url-embed">url-embed</h1>
<p>A flexible <strong>ES6</strong> class-based system that supports converting URLs into embed code. </p>
<p>The module provides support for many common oembed providers, as well as support for creating your own custom providers.</p>
<p><a href="http://mkopit.github.io/url-embed/">API Documentation Lives Here</a></p>
<h2 id="the-basics">The Basics</h2>
<h4 id="this-module-exports-the-following-properties-">This module exports the following properties:</h4>
<ul>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/Embed.js~Embed.html">EmbedEngine</a> class: given one or more urls will resolve them to corresponding markup.</li>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/URLEmbedProvider.js~URLEmbedProvider.html">URLEmbedProvider</a> interface: defines the basic methods that will get invoked by EmbedEngine</li>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/OEmbedProvider.js~OEmbedProvider.html">OEmbedProvider</a> interface: extends URLEmbedProvider and implements support for interacting with an oembed provider&apos;s API</li>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/Embed.js~Embed.html">Embed</a> class: the primary object passed through callbacks<ul>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/Embed.js~Embed.html#instance-member-error">error</a>: contains a reference to an Error object if an error occurred</li>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/Embed.js~Embed.html#instance-member-options">embedOptions</a>: options object the Embed was constructed from<ul>
<li>embedURL: the URL to embed</li>
</ul>
</li>
<li><a href="http://mkopit.github.io/url-embed/docs/esdoc/class/lib/classes/Embed.js~Embed.html#instance-member-data">data</a>: the data object from the resolved embed<ul>
<li>html: the resulting embed markup.</li>
</ul>
</li>
</ul>
</li>
<li>defaultProviderClasses: map of all default providers indexed by provider name:<ul>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/DailyMotion.js~DailyMotion.html">DailyMotion</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/FacebookPosts.js~FacebookPosts.html">FacebookPosts</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/FacebookVideo.js~FacebookVideo.html">FacebookVideo</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Flickr.js~Flickr.html">Flickr</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Imgur.js~Imgur.html">Imgur</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Instagram.js~Instagram.html">Instagram</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Soundcloud.js~SoundCloud.html">Soundcloud</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Spotify.js~Spotify.html">Spotify</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Tumblr.js~Tumblr.html">Tumblr</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Twitter.js~Twitter.html">Twitter</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Videopress.js~Videopress.html">Videopress</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Vimeo.js~Vimeo.html">Vimeo</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/default_providers/Youtube.js~Youtube.html">Youtube</a></li>
</ul>
</li>
<li>errorClasses: map of all error classes:<ul>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/errors/EmbedValidationError.js~EmbedValidationError.html">EmebedValidationError</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/errors/UnexpectedStatusError.js~UnexpectedStatusError.html">UnexpectedStatusError</a></li>
<li><a href="http://mkopit.github.io/url-embed/class/lib/classes/errors/UnknownProviderError.js~UnknownProviderError.html">UnknownProviderError</a></li>
</ul>
</li>
</ul>
<p>&#xA0;</p>
<p>Example: Resolving a single embed</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;;

let EmbedEngine = require(&apos;url-embed&apos;).EmbedEngine;
let engine = new EmbedEngine({
  timeoutMs: 2000,
  referrer: &apos;www.example.com&apos;
});
engine.registerDefaultProviders();

let embedOptions = {
  embedURL: &apos;https://www.youtube.com/watch?v=dQw4w9WgXcQ&apos;,
  maxHeight: 300
}

// Get single embed
engine.getEmbed(embedOptions, function(embed) {
  if (embed.error) {
    console.log(&apos;Something went wrong.&apos;);
    console.log(err.stack);
  }

  // Embed markup
  console.log(embed.data.html);
});</code>
</code></pre>
<p>&#xA0;</p>
<p>Example: Resolving muliple embeds in parallel</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;;

let engine = new (require(&apos;url-embed&apos;).EmbedEngine)({
  timeoutMs: 2000,
  referrer: &apos;www.example.com&apos;
});

engine.registerDefaultProviders();

let embedOptionArray = [
  {embedURL: &apos;https://www.instagram.com/p/BCA0qkon9B1/?taken-by=mtv&apos;},
  {embedURL: &apos;https://soundcloud.com/newyorker/listen-to-craig-raine-read-bitch&apos;},
  {embedURL: &apos;https://www.youtube.com/watch?v=2LO4QL_i8is&apos;},
  {embedURL: &apos;https://vimeo.com/156045670&apos;},
  {embedURL: &apos;http://soundcloud.com/forss/flickermood&apos;},
  {embedURL: &apos;https://www.flickr.com/photos/sas999/25092061391/in/explore-2016-02-22/&apos;},
  {embedURL: &apos;http://www.dailymotion.com/video/x3lwpy7_the-worst-car-in-the-history-of-the-world-top-gear-bbc_auto&apos;},
  {embedURL: &apos;https://www.facebook.com/facebook/videos/10153231379946729/&apos;},
  {embedURL: &apos;https://www.facebook.com/MTV/posts/10153553500401701&apos;},
  {embedURL: &apos;https://twitter.com/simpscreens/status/702025133951680512&apos;},
  {embedURL: &apos;http://imgur.com/gallery/KSMB2tI&apos;},
  {embedURL: &apos;https://play.spotify.com/track/0ivpUENLpheuPoa6VuY1ax&apos;},
  {embedURL: &apos;http://mtv.tumblr.com/post/139813756155/kanye-west-taking-a-kanye-rest-so-he-can-do-his&apos;},
  {embedURL: &apos;https://videopress.com/v/kUJmAcSf&apos;},
  {embedURL: &apos;http://www.example.com/foo&apos;}
];

// Get multiple embeds
engine.getMultipleEmbeds(embedOptionArray, function (error, results) {
  if (error) {
    // Something horrible killed the whole process. Spooky.
  } else {
    for (let i = 0; i &lt; results.length; i++) {
      let embed = results[i];

      console.log(&apos;\nEmbed for &apos; + embed.options.embedURL);
      if (embed.error) {
        console.log(&apos;A tragedy occurred: &apos; + embed.error);
      }
      console.log(embed.data.html);
    }
  }
});</code>
</code></pre>
<h2 id="creating-your-own-url-embed-providers">Creating Your Own URL Embed Providers</h2>
<p>You can extend URLEmbedProvider and OEmbedProvider to make your own embed providers.</p>
<p>Example: Creating a new oembed provider</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;;

let OEmbedProvider = (require(&apos;url-embed&apos;)).OEmbedProvider;

class SoundCloud extends OEmbedProvider {}

// Name of provider
SoundCloud.prototype.name = &apos;soundcloud&apos;;

// oembed API URL
SoundCloud.prototype.providerURL = &apos;http://soundcloud.com/oembed&apos;;

// List of RegExp patterns to match provider urls
SoundCloud.prototype.urlPatterns = [&apos;^https?://(www\.)?soundcloud\.com/.*&apos;];

// Format indicates the response type of the oembed API
SoundCloud.prototype.format = &apos;json&apos;;

module.exports = SoundCloud;</code>
</code></pre>
<p>&#xA0;</p>
<p>Example: Creating a custom provider</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;;

let URLEmbedProvider = (require(&apos;url-embed&apos;)).URLEmbedProvider;

class CustomProvider extends URLEmbedProvider {

  /*
  * @override
  */
  getEmbed (embed, callback) {
    let embedURL = embed.options.embedURL;

    try {
      embed.data.html = &apos;&lt;iframe src=&quot;http://www.example.com/embed/video/12345&quot; width=&quot;512&quot; height=&quot;288&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&apos;;
      this.filterData(embed.data);
      callback(embed);
    } catch (error) {
      embed.data = {
        html: this.errorMarkup(embedURL)
      };
      embed.error = error;
      callback(embed);
    }
  }

  /*
  * Optional custom override of function that generates error markup.
  * @override
  */
  errorMarkup (embed, error, errorMessage) {
    return &apos;Oops. Something went wrong for: &lt;a href=&quot;&apos; + embed.options.embedURL + &apos;&quot;&gt;&apos; + embed.options.embedURL + &apos;&lt;/a&gt;&apos;;
  }
}

CustomProvider.prototype.name = &apos;custom&apos;;
CustomProvider.prototype.urlPatterns = [&apos;^https?://www\.example\.com/video/.*&apos;];

module.exports = CustomProvider;</code>
</code></pre>
<p>&#xA0;</p>
<p>Example: registering a provider with the EmbedEngine</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;

let CustomProvider = require(&apos;./custom_provider&apos;);

let engine = new require(&apos;url-embed&apos;).EmbedEngine({
  timeoutMs: 2000,
  referrer: &apos;www.example.com&apos;
});

engine.registerProvider(new CustomProvider());</code>
</code></pre>
<h2 id="other-tips-tricks-and-feats-of-strength">Other tips, tricks and feats of strength</h2>
<p>Example: Modifying an existing provider by extending its class</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;;

let urlEmbed = require(&apos;url-embed&apos;);
let EmbedEngine = urlEmbed.EmbedEngine;
let engine = new EmbedEngine();

let defaultProviderClasses = urlEmbed.defaultProviderClasses;
let Youtube = defaultProviderClasses.Youtube;

// Class level override of filterData
class BetterYoutubeProvider extends Youtube {
  filterData(data) {
    data.html = &apos;YOLO!!!! &apos; + data.html
  }
}

// Test it out
engine.registerProvider(new BetterYoutubeProvider());

engine.getEmbed({embedURL: &apos;https://www.youtube.com/watch?v=dQw4w9WgXcQ&apos;}, function(embed) {
  console.log(embed.data.html);
});

/**
* Outputs:
* YOLO!!!! &lt;iframe width=&quot;459&quot; height=&quot;344&quot; src=&quot;https://www.youtube.com/embed/dQw4w9WgXcQ?feature=oembed&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;
*/</code>
</code></pre>
<p>Example:</p>
<ul>
<li>Modifying the embed code for an <strong>instance</strong> of an existing provider</li>
<li>Modifying the embed code for <strong>all</strong> providers</li>
</ul>
<pre><code class="lang-javascript"><code class="source-code prettyprint">&apos;use strict&apos;;

let urlEmbed = require(&apos;url-embed&apos;);
let EmbedEngine = urlEmbed.EmbedEngine;
let engine = new EmbedEngine();

let defaultProviderClasses = urlEmbed.defaultProviderClasses;
let Youtube = defaultProviderClasses.Youtube;
let provider = new Youtube();

// Instance-level override of Youtube.filterData.
provider.filterData = function (data) {
  data.html = &apos;YOLO!!!! &apos; + data.html
}

engine.registerDefaultProviders();

// Instance level override of EmbedEngine.filterData
engine.filterData = function(data) {
  data.html = &apos;&lt;hug&gt;&apos; + data.html + &apos;&lt;/hug&gt;&apos;;
}

engine.registerProvider(provider);

engine.getEmbed({embedURL: &apos;https://www.youtube.com/watch?v=dQw4w9WgXcQ&apos;}, function(embed) {
  console.log(embed.data.html);
});

engine.getEmbed({embedURL: &apos;https://play.spotify.com/track/0ivpUENLpheuPoa6VuY1ax&apos;}, function(embed) {
  console.log(embed.data.html);
});

/*
* Outputs:
* &lt;hug&gt;YOLO!!!! &lt;iframe width=&quot;459&quot; height=&quot;344&quot; src=&quot;https://www.youtube.com/embed/dQw4w9WgXcQ?feature=oembed&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;&lt;/hug&gt;
* &lt;hug&gt;&lt;iframe src=&quot;https://embed.spotify.com/?uri=spotify:track:0ivpUENLpheuPoa6VuY1ax&quot; width=&quot;300&quot; height=&quot;380&quot; frameborder=&quot;0&quot; allowtransparency=&quot;true&quot;&gt;&lt;/iframe&gt;&lt;/hug&gt;
*/</code>
</code></pre>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.5)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
